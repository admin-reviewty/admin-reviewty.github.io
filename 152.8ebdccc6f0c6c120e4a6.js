"use strict";(self.webpackChunkadmin_angular=self.webpackChunkadmin_angular||[]).push([[152],{9152:(ot,F,i)=>{i.r(F),i.d(F,{CautionModule:()=>at});var f=i(8583),r=i(3679),v=i(9790),h=i(6271),A=i(5392),T=i(4453),b=i(464),z=i(7674),y=i(7018),p=i(6795),$=i(2746),Z=i(5887),L=i(8058),x=i(269),N=i(4788),V=i(1841),D=i(4828),d=i(5987),q=i(9765),P=i(5917),C=i(6782),S=i(8002),_=i(9773),G=i(3815),U=i.n(G),c=i(7071),t=i(7716),M=i(4701),Q=i(4514),J=i(6704),O=i(9374),j=i(9206);function B(e,u){if(1&e&&(t._uU(0),t.ALo(1,"emojiFlagFromLanguageCode"),t.ALo(2,"translate"),t.ALo(3,"lowercase")),2&e){const n=t.oxw().$implicit;t.AsE("",t.lcZ(1,2,n.value.language)," ",t.lcZ(2,4,"language."+t.lcZ(3,6,n.value.language)),"")}}const E=function(){return{minRows:5,maxRows:10}};function K(e,u){if(1&e&&(t.TgZ(0,"nz-tab",11),t.YNc(1,B,4,8,"ng-template",null,12,t.W1O),t.TgZ(3,"nz-form-item"),t.TgZ(4,"nz-form-label"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"nz-form-control",13),t.ALo(8,"translate"),t.TgZ(9,"nz-select",14),t._UZ(10,"nz-option",15),t.ALo(11,"translate"),t._UZ(12,"nz-option",15),t.ALo(13,"translate"),t._UZ(14,"nz-option",15),t.ALo(15,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"nz-form-item"),t.TgZ(17,"nz-form-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"nz-form-control",13),t.ALo(21,"translate"),t._UZ(22,"input",16),t.qZA(),t.qZA(),t.TgZ(23,"nz-form-item"),t.TgZ(24,"nz-form-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"nz-form-control",17),t._UZ(28,"textarea",18),t.qZA(),t.qZA(),t.qZA()),2&e){const n=u.index,a=t.MAs(2),o=t.oxw();t.Q6J("formGroupName",n)("nzTitle",a)("nzClosable",o.translations.controls.length>1),t.xp6(5),t.Oqu(t.lcZ(6,15,"common.language")),t.xp6(2),t.s9C("nzErrorTip",t.lcZ(8,17,"ui.form.should_not_be_empty")),t.xp6(3),t.Q6J("nzValue",o.LanguageCode.Vi)("nzLabel","\u{1f1fb}\u{1f1f3} "+t.lcZ(11,19,"language.vi")),t.xp6(2),t.Q6J("nzValue",o.LanguageCode.En)("nzLabel","\u{1f1fa}\u{1f1f8} "+t.lcZ(13,21,"language.en")),t.xp6(2),t.Q6J("nzValue",o.LanguageCode.Ko)("nzLabel","\u{1f1f0}\u{1f1f7} "+t.lcZ(15,23,"language.ko")),t.xp6(4),t.Oqu(t.lcZ(19,25,"caution.name")),t.xp6(2),t.s9C("nzErrorTip",t.lcZ(21,27,"ui.form.should_not_be_empty")),t.xp6(5),t.Oqu(t.lcZ(26,29,"caution.description")),t.xp6(3),t.Q6J("nzAutosize",t.DdM(31,E))}}const I=function(){return[]};let R=(()=>{class e{constructor(n,a,o,s,l,g,m,et){this.fb=n,this.route=a,this.location=o,this.createCautionGQL=s,this.updateCautionGQL=l,this.msgService=g,this.translateService=m,this.languageService=et,this.LanguageCode=c.spR,this.destroy$=new q.xQ,this.loading=!1,this.validateForm=this.fb.group({translations:this.fb.array([],r.kI.required)})}ngOnInit(){this.route.data.pipe((0,C.R)(this.destroy$),(0,S.U)(n=>n.caution)).subscribe(n=>{var a;this.caution=n,this.validateForm.setControl("translations",this.fb.array(this.languageService.sort([...(null===(a=this.caution)||void 0===a?void 0:a.translations)||[]]).map(o=>this.fb.group({id:[o.id],name:[o.name,r.kI.required],language:[o.language,r.kI.required],description:[o.description]}))||[],r.kI.required))})}get translations(){return this.validateForm.get("translations")}addTab(){const n=new Set([c.spR.Vi,c.spR.En,c.spR.Ko]);this.translations.controls.forEach(o=>n.delete(o.value.language));const a=0===n.size?c.spR.Vi:n.values().next().value;this.translations.push(this.fb.group({id:[],name:[null,r.kI.required],language:[a,r.kI.required],description:[]}))}removeTab(n){this.translations.removeAt(n)}submit(){var n;Object.values(this.validateForm.controls).forEach(a=>{a.markAsDirty(),a.updateValueAndValidity()}),!this.validateForm.invalid&&(this.loading=!0,(0,P.of)(null===(n=this.caution)||void 0===n?void 0:n.id).pipe((0,C.R)(this.destroy$),(0,_.zg)(a=>{var o,s,l;if(a){const g={translations:{create:null===(o=this.translations.value)||void 0===o?void 0:o.filter(m=>!m.id).map(m=>U().omit(m,["id"])),set:null===(s=this.translations.value)||void 0===s?void 0:s.filter(m=>m.id)}};return this.updateCautionGQL.mutate({where:{id:a},data:g})}{const g={translations:{create:null===(l=this.translations.value)||void 0===l?void 0:l.map(m=>U().omit(m,["id"]))}};return this.createCautionGQL.mutate({data:g})}})).subscribe(({errors:a,data:o})=>{var s,l;a&&this.msgService.error(this.translateService.instant(`caution.${(null===(s=this.caution)||void 0===s?void 0:s.id)?"update":"create"}_error`)),o&&(this.msgService.success(this.translateService.instant(`caution.${(null===(l=this.caution)||void 0===l?void 0:l.id)?"update":"create"}_success`)),this.location.back()),this.loading=!1},()=>{var a;this.msgService.error(this.translateService.instant(`caution.${(null===(a=this.caution)||void 0===a?void 0:a.id)?"update":"create"}_error`)),this.loading=!1}))}cancel(){this.location.back()}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(r.qu),t.Y36(d.gz),t.Y36(f.Ye),t.Y36(c.ux4),t.Y36(c.TSU),t.Y36(L.dD),t.Y36(v.sK),t.Y36(M.T))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-caution-details"]],decls:24,vars:17,consts:[[1,"site-page-header"],["nz-page-header-breadcrumb",""],["nz-icon","","nzType","home"],["routerLink","/cautions"],["nz-form","",3,"nzLayout","formGroup","ngSubmit"],[1,"mb-3"],["nzType","editable-card","formArrayName","translations",3,"nzAdd","nzClose"],["nzClosable","",3,"formGroupName","nzTitle","nzClosable",4,"ngFor","ngForOf"],[1,"mt-2","pb-4"],["nz-button","","nzType","primary",3,"nzLoading"],["nz-button","","type","button",1,"ml-2",3,"nzDanger","click"],["nzClosable","",3,"formGroupName","nzTitle","nzClosable"],["title",""],["nzHasFeedback","",3,"nzErrorTip"],["formControlName","language"],[3,"nzValue","nzLabel"],["nz-input","","formControlName","name"],["nzHasFeedback",""],["nz-input","","formControlName","description",3,"nzAutosize"]],template:function(n,a){1&n&&(t.TgZ(0,"nz-page-header",0),t.TgZ(1,"nz-breadcrumb",1),t.TgZ(2,"nz-breadcrumb-item"),t._UZ(3,"i",2),t.qZA(),t.TgZ(4,"nz-breadcrumb-item"),t.TgZ(5,"a",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"nz-breadcrumb-item"),t.TgZ(9,"a"),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"form",4),t.NdJ("ngSubmit",function(){return a.submit()}),t.TgZ(12,"nz-card",5),t.TgZ(13,"nz-tabset",6),t.NdJ("nzAdd",function(){return a.addTab()})("nzClose",function(s){return a.removeTab(s.index)}),t.YNc(14,K,29,32,"nz-tab",7),t.qZA(),t.qZA(),t.TgZ(15,"nz-form-item",8),t.TgZ(16,"nz-form-control"),t.TgZ(17,"nz-input-group"),t.TgZ(18,"button",9),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",10),t.NdJ("click",function(){return a.cancel()}),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(6),t.Oqu(t.lcZ(7,9,"common.caution")),t.xp6(4),t.Oqu(null==((null==a.caution?null:a.caution.translations)||t.DdM(15,I))[0]?null:((null==a.caution?null:a.caution.translations)||t.DdM(16,I))[0].name),t.xp6(1),t.Q6J("nzLayout","vertical")("formGroup",a.validateForm),t.xp6(3),t.Q6J("ngForOf",a.translations.controls),t.xp6(4),t.Q6J("nzLoading",a.loading),t.xp6(1),t.hij(" ",t.lcZ(20,11,null!=a.caution&&a.caution.id?"common.update":"common.add")," "),t.xp6(2),t.Q6J("nzDanger",!0),t.xp6(1),t.hij(" ",t.lcZ(23,13,"common.cancel")," "))},directives:[h.$O,A.Dg,h.A2,A.MO,Q.w,b.Ls,d.yS,r._Y,r.JL,Z.Lr,r.sg,y.bd,D.xH,r.CE,f.sg,J.SK,Z.Nx,J.t3,Z.Fd,z.gB,T.ix,O.dQ,D.xw,r.x0,Z.iK,x.Vq,r.JJ,r.u,x.Ip,z.Zp,r.Fj,z.rh],pipes:[v.X$,j.o,f.i8],styles:[""]}),e})();function H(e,u){1&e&&(t.TgZ(0,"button",15),t._UZ(1,"i",16),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"common.search")," "))}const X=function(e){return["/cautions",e]};function W(e,u){if(1&e&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.TgZ(8,"a",17),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.qZA(),t.qZA()),2&e){const n=u.$implicit;t.xp6(2),t.Oqu(n.id),t.xp6(2),t.hij(" ",null==n.translations[0]?null:n.translations[0].name," "),t.xp6(2),t.hij(" ",null==n.translations[0]?null:n.translations[0].description," "),t.xp6(2),t.Q6J("routerLink",t.VKq(7,X,n.id)),t.xp6(1),t.Oqu(t.lcZ(10,5,"common.edit"))}}let w=(()=>{class e{constructor(n,a,o,s,l,g){this.fb=n,this.router=a,this.route=o,this.getFunctionListGQL=s,this.msgService=l,this.translateService=g,this.destroy$=new q.xQ,this.cautions=[],this.cautionsCount=0,this.pageIndex=1,this.pageSize=10,this.loading=!1,this.searchForm=this.fb.group({name:[null]})}ngOnInit(){this.route.queryParamMap.pipe((0,C.R)(this.destroy$)).subscribe(n=>{var a;this.pageIndex=parseInt(n.get("page")||"1",10),this.pageSize=parseInt(n.get("size")||"10",10),this.text=n.get("text")||"",this.patchFormValue(),this.dataSubscription?null===(a=this.dataQueryRef)||void 0===a||a.refetch(this.getVariables()):(this.dataQueryRef=this.getFunctionListGQL.watch(this.getVariables(),{notifyOnNetworkStatusChange:!0,fetchPolicy:"network-only"}),this.dataSubscription=this.dataQueryRef.valueChanges.pipe((0,C.R)(this.destroy$)).subscribe(({data:o,loading:s,error:l,errors:g})=>{if(this.loading=s,!s){if(l||g)return void this.msgService.error(this.translateService.instant("ui.message.can_not_load_data"));o&&(this.cautions=o.cautions,this.cautionsCount=o.cautionsConnection.aggregate.count)}}))})}getVariables(){var n;return{first:this.pageSize,skip:(this.pageIndex-1)*this.pageSize,where:{translationsSome:{nameContains:(null===(n=this.text)||void 0===n?void 0:n.trim())||void 0}},orderBy:{id:c.d$J.Desc}}}patchFormValue(){this.text&&this.searchForm.controls.name.untouched&&this.searchForm.patchValue({name:this.text})}handleQueryParamsChange(n){this.router.navigate([],{queryParams:{page:n.pageIndex,size:n.pageSize},relativeTo:this.route,queryParamsHandling:"merge"})}handleSearch(){this.router.navigate([],{queryParams:{text:this.searchForm.value.name||void 0,page:1},relativeTo:this.route,queryParamsHandling:"merge"})}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(r.qu),t.Y36(d.F0),t.Y36(d.gz),t.Y36(c.hwx),t.Y36(L.dD),t.Y36(v.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-caution-list"]],decls:38,vars:27,consts:[[1,"site-page-header",3,"nzTitle"],["nz-page-header-breadcrumb",""],["nz-icon","","nzType","home"],["nz-button","","nzType","primary","routerLink","/cautions/new"],["nz-icon","","nzType","plus","nzTheme","outline"],[1,"mb-3"],["nz-form","",3,"formGroup","ngSubmit"],[1,"row","justify-content-lg-center"],[1,"col-12","col-lg-6"],["nzSearch","",3,"nzAddOnAfter"],["formControlName","name","type","text","nz-input","",3,"placeholder"],["suffixIconButton",""],[1,"mb-4"],["nzBordered","",3,"nzData","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzLoading","nzQueryParams"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary","type","submit","nzSearch",""],["nz-icon","","nzType","search","nzTheme","outline"],[3,"routerLink"]],template:function(n,a){if(1&n&&(t.TgZ(0,"nz-page-header",0),t.ALo(1,"translate"),t.TgZ(2,"nz-breadcrumb",1),t.TgZ(3,"nz-breadcrumb-item"),t._UZ(4,"i",2),t.qZA(),t.TgZ(5,"nz-breadcrumb-item"),t.TgZ(6,"a"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"nz-page-header-extra"),t.TgZ(10,"button",3),t._UZ(11,"i",4),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"nz-card",5),t.TgZ(15,"form",6),t.NdJ("ngSubmit",function(){return a.handleSearch()}),t.TgZ(16,"div",7),t.TgZ(17,"div",8),t.TgZ(18,"nz-input-group",9),t._UZ(19,"input",10),t.ALo(20,"translate"),t.qZA(),t.YNc(21,H,4,3,"ng-template",null,11,t.W1O),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"nz-card",12),t.TgZ(24,"nz-table",13),t.NdJ("nzQueryParams",function(s){return a.handleQueryParamsChange(s)}),t.TgZ(25,"thead"),t.TgZ(26,"tr"),t.TgZ(27,"th"),t._uU(28,"ID"),t.qZA(),t.TgZ(29,"th"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"th"),t._uU(33),t.ALo(34,"translate"),t.qZA(),t._UZ(35,"th"),t.qZA(),t.qZA(),t.TgZ(36,"tbody"),t.YNc(37,W,11,9,"tr",14),t.qZA(),t.qZA(),t.qZA()),2&n){const o=t.MAs(22);t.s9C("nzTitle",t.lcZ(1,15,"common.caution")),t.xp6(7),t.Oqu(t.lcZ(8,17,"common.caution")),t.xp6(5),t.hij(" ",t.lcZ(13,19,"caution.create")," "),t.xp6(3),t.Q6J("formGroup",a.searchForm),t.xp6(3),t.Q6J("nzAddOnAfter",o),t.xp6(1),t.s9C("placeholder",t.lcZ(20,21,"function.name")),t.xp6(5),t.Q6J("nzData",a.cautions)("nzFrontPagination",!1)("nzTotal",a.cautionsCount)("nzPageIndex",a.pageIndex)("nzPageSize",a.pageSize)("nzLoading",a.loading),t.xp6(6),t.Oqu(t.lcZ(31,23,"caution.name")),t.xp6(3),t.Oqu(t.lcZ(34,25,"caution.description")),t.xp6(4),t.Q6J("ngForOf",a.cautions)}},directives:[h.$O,A.Dg,h.A2,A.MO,Q.w,b.Ls,h.Jp,T.ix,O.dQ,d.rH,y.bd,r._Y,r.JL,Z.Lr,r.sg,z.gB,r.Fj,z.Zp,r.JJ,r.u,p.N8,p.Om,p.$Z,p.Uo,p._C,p.p0,f.sg,d.yS],pipes:[v.X$],styles:[""]}),e})(),Y=(()=>{class e{constructor(n,a){this.getCautionDetailsGQL=n,this.router=a}resolve(n){const a=parseInt(n.paramMap.get("id")||"",10);return a?this.getCautionDetailsGQL.fetch({where:{id:a}},{fetchPolicy:"network-only"}).pipe((0,S.U)(o=>{var s;if(!o.error&&!o.errors)return(null===(s=o.data)||void 0===s?void 0:s.caution)?o.data.caution:void this.router.navigateByUrl("/exception/404");this.router.navigateByUrl("/exception/500")})):{translations:[{language:c.spR.Vi}]}}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(c.nhJ),t.LFG(d.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const k=[{path:"new",resolve:{caution:Y},component:R},{path:":id",resolve:{caution:Y},component:R},{path:"",pathMatch:"full",component:w}];let tt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.Bz.forChild(k)],d.Bz]}),e})();var nt=i(7615);let at=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.ez,tt,r.u5,r.UX,nt.m,v.aw.forChild(),h.KJ,A.lt,T.sL,b.PV,z.o7,y.vh,p.HQ,L.gR,$.wm,Z.U5,x.LV,N.cS,V.JF,D.we]]}),e})()}}]);